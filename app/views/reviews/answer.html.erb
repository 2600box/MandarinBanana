<h1>
  <%= link_to @hanzi.character, @hanzi %><br/>
</h1>

<%= render partial: "hanzis/hanzi", locals: {hanzi: @hanzi} %>

<% if !@stroke_order.nil? %>
<h2>Wikimedia Commons:Stroke Order Project</h2>
  <div class="row-fluid text-center">
    <a href="http://commons.wikimedia.org/wiki/Commons:Stroke_Order_Project" target="_blank">
      <%= image_tag @stroke_order %>
    </a>
  </div>
<% end %>

<div class="row-fluid, center">
  <%= render partial: "subtitles/subtitle", collection: @subtitles, locals: {morelink: true, replace: false, autoplay: 0, width: 200, height: 200, reviewing: true} %>
</div>

<h2>Review</h2>
<% if signed_in? %>
  <% @review = current_user.reviews.find_by(hanzi_id: @hanzi.id) %>
  <div class="center">
  <% if @review.nil? %>
    <%= form_for(current_user.reviews.build(hanzi_id: @hanzi.id)) do |f| %>
      <div><%= f.hidden_field :hanzi_id %></div>
      <%= f.submit "Review this character", class: "btn btn-large btn-primary" %>
    <% end %>
  <% else %>
    <%= form_for(current_user.reviews.find_by(hanzi_id: @hanzi.id), html: { method: :delete}) do |f| %>
      <div><%= f.hidden_field :hanzi_id %></div>
      <%= f.submit "Stop reviewing", class: "btn btn-large btn-primary" %>
    <% end %>  
  <% end %>
  </div>
<% end %>

<% if @hanzi.comments.any? %>
<div>
  <h2> Comments (<%= @hanzi.comments.count %>)</h2>
  <ol class="comments">
    <%= render @comments %>
  </ol>
</div>
<% end %>

<div class="row-fluid center">
  <p>Rate yourself:</p>
  <%= link_to "Again", {controller: "reviews", action: "fail", review_id: @review.id}, class: "btn btn-large btn-primary" %>
  <%= link_to "Hard", {controller: "reviews", action: "validate", review_id: @review.id, rating: 2}, class: "btn btn-large btn-primary" %>
  <%= link_to "Okay", {controller: "reviews", action: "validate", review_id: @review.id, rating: 3}, class: "btn btn-large btn-primary" %>
  <%= link_to "Easy", {controller: "reviews", action: "validate", review_id: @review.id, rating: 4}, class: "btn btn-large btn-primary" %>
</div>

