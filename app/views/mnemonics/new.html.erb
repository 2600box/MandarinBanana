<% @ancestor = Pinyindefinition.find_by(id: @id).pinyin if @parent == "pinyindefinitions" %>
<% @ancestor = Gorodish.find_by(id: @id).element if @parent == "gorodishes" %>

<% if @parent == "pinyindefinitions" %>
  <h1>Invent a new mnemonic for <%= @hanzi.character %></h1>
  <b><a href="/hanzis/<%= @hanzi.id %>"><%= @hanzi.character %></a> <%= @pinyindefinition.pinyin %>
  <%= " | " if !@gbeginning.empty? %>
  <%= link_to @gbeginning, @gbeginning_obj if @gbeginning %><%= link_to @gending, @ending_obj if @gending %></b>:
  <%= @pinyindefinition.definition %>
  <% if !@gbeginning_obj.nil? %>
    <h2>Mnemonics for <%= @gbeginning %>:</h2>
    <% @gbeginning_obj.mnemonics.each do |mnemonic| %>
      <%= mnemonic.aide %>  - <a href="/mnemonics/<%= mnemonic.id %>/images/new">add image</a><br/>
      <% mnemonic.images.each do |image| %>
        <img width=100 src="<%= image.data %>">
      <% end %><br/>
    <% end %>
    <a href="/gorodishes/<%= @gbeninning_obj %>/mnemonics/new">add mnemonic</a></br>
  <% end %>
  <% if !@gending_obj.nil? %>
    <h2>Mnemonics for <%= @gending %>:</h2>
    <% @gending_obj.mnemonics.each do |mnemonic| %>
      <%= mnemonic.aide %>  - <a href="/mnemonics/<%= mnemonic.id %>/images/new">add image</a><br/>
      <% mnemonic.images.each do |image| %>
        <img width=100 src="<%= image.data %>">
      <% end %><br/>
    <% end %>
    <a href="/gorodishes/<%= @gending_obj %>/mnemonics/new">add mnemonic</a></br>
  <% end %>
  <h2>Components of <%= @hanzi.character %></h2>
  <% if !@hanzi.components.to_s.empty? %>
    <%= decompose @hanzi.components %>
  <% else %>
    <%= @hanzi.character %> has no components.
  <% end %>
  <% if @pinyindefinition.mnemonics.count > 0 %>
    <h2>Current mnemonics:</h2>
    <% @pinyindefinition.mnemonics.each do |mnemonic| %>
      <%= mnemonic.aide %><br/>
      <% mnemonic.images.each do |image| %>
        <img width=100 src="<%= image.data %>">
      <% end %><br/>
    <% end %>
  <% else %>
    <h2>There are no mnemonics for <%= @hanzi.character %> yet.</h2>
  <% end %>
<% end %>

<% if @parent == "gorodishes" %>
  <h1>Invent a new mnemonic for <%= @ancestor %></h1>
  <% if Gorodish.find_by(id: @id).mnemonics.count > 0 %>
    <h2>Current mnemonics:</h2>
    <% Gorodish.find_by(id: @id).mnemonics.each do |mnemonic| %>
      <%= mnemonic.aide %><br/>
    <% end %>
  <% end %>
<% end %>

<%= render partial: "hanzis/appearance" %>

<% if signed_in? %>
<h2>Your new mnemonic:</h2>
<div>
  <%= render 'shared/mnemonics_form' %>
</div>
<% end %>
